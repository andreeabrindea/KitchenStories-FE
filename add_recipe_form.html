<!DOCTYPE html>
<html lang="en">
<head>
<title>Kitchen Stories</title>
<link rel="stylesheet" type="text/css" href="style_form.css">
<meta charset="UTF-8">
</head>
<body>
    <div class="homepage">
		<div class="topbar">
			<a href="home.html"><img src="carlos-fernandez-w3awZjfVa6w-unsplash.jpg" alt="TopBar Photo"></a>
			<div class="links">
				<a href="home.html">Home</a>
				<a href="add_recipe_form.html">Add Recipe</a>
                <a href="register_page.html">Sign up</a>
			</div>
		</div>
        <form>
            <h2>Add a New Recipe</h2>
          
            <label for="name">Recipe Name:</label>
            <input type="text" id="name" name="name" required>
          
            <label for="photo">Recipe Photo:</label>
            <input type="text" id="photo" name="photo" required>

            <label for="ingredients">Ingredients:</label>
            <textarea id="ingredients" name="ingredients" rows="4" required></textarea>
          
            <label for="instructions">Instructions:</label>
            <textarea id="instructions" name="instructions" rows="8" required></textarea>
          
            <button type="submit">Add Recipe</button>
          </form>
          <footer>
			<p>Â© This is a faculty assignment. It is inspired by the real Kitchen Stories, https://www.kitchenstories.com. The photos are taken from here: https://unsplash.com
            </p>	
		</footer>  
    </div>

<script>
const form = document.querySelector('form');
const submitButton = form.querySelector('button[type="submit"]');

submitButton.addEventListener('click', (event) => {
  event.preventDefault();
  let min = 1;
  let max = 100;
  const id = Math.floor(Math.random() * (max - min + 1)) + min;
  const recipeName = form.querySelector('#name').value;
  const user_id = 2;
  const recipePhoto = form.querySelector('#name').value;
  const recipeIngredients = form.querySelector('#ingredients').value;
  const recipeInstructions = form.querySelector('#instructions').value;

  const formData = {
    id: id,
    name: recipeName,
    user_id: 2,
    photo: recipePhoto,
    ingredients: recipeIngredients,
    instructions: recipeInstructions
  };
  
  const xhr = new XMLHttpRequest();
  xhr.open('POST', 'https://kitchenstoriesbe.fly.dev/api/recipes');
  xhr.setRequestHeader('Content-Type', 'application/json');
  xhr.onload = () => {
    if (xhr.status === 200) {
      // Recipe added successfully
      console.log('Recipe added successfully');
      // Redirect to homepage or show success message
    } else {
      // Error adding recipe
      console.error('Error adding recipe');
      // Show error message
    }
  };
  xhr.onerror = () => {
    console.error('Error adding recipe');
    // Show error message
  };
  xhr.send(JSON.stringify(formData));
  window.location.href = 'home_as_login.html';
});

</script>
</body>
</html>
